# ================================================================
# API Service - Standalone Environment Configuration
# ================================================================
# Use this for local development outside Docker Compose
# For Docker Compose deployment, use infra/compose/.env
# ================================================================

# ========== DATABASE (Keep as-is) ==========
DATABASE_URL=postgresql+psycopg://postgres:postgres@host.docker.internal:5432/lostfound
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=40
DB_POOL_TIMEOUT=30
DB_ECHO=false

# ========== REDIS ==========
REDIS_URL=redis://localhost:6379/0

# ========== JWT AUTHENTICATION ==========
JWT_SECRET_KEY=a7f9e2b8c4d1f6a3e8b2c7d9f4e1a6b3c8d2e7f1a4b9c3d8e2f7a1b6c4d9e3f8
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
JWT_REFRESH_TOKEN_EXPIRE_DAYS=30

# ========== SERVER CONFIGURATION ==========
ENVIRONMENT=development
DEBUG=true
HOST=0.0.0.0
PORT=8000
WORKERS=1
LOG_LEVEL=INFO

# ========== SERVICE INTEGRATION ==========
# For local development, services may run on localhost
NLP_SERVICE_URL=http://localhost:8001
VISION_SERVICE_URL=http://localhost:8002
NLP_SERVICE_TIMEOUT=30
VISION_SERVICE_TIMEOUT=30

# ========== MEDIA ==========
MEDIA_ROOT=./media
MAX_UPLOAD_SIZE_MB=10
ALLOWED_IMAGE_FORMATS=jpg,jpeg,png,webp

# ========== CORS ==========
CORS_ORIGINS=http://localhost:5173,http://localhost:3000,http://localhost:8000
CORS_ALLOW_CREDENTIALS=true

# ========== MATCHING ALGORITHM ==========
MATCH_WEIGHT_TEXT=0.45
MATCH_WEIGHT_IMAGE=0.35
MATCH_WEIGHT_GEO=0.15
MATCH_WEIGHT_TIME=0.05
MATCH_MIN_SCORE=0.65

# ========== RATE LIMITING ==========
RATE_LIMIT_ENABLED=true
RATE_LIMIT_AUTH=10/minute
RATE_LIMIT_UPLOAD=20/minute

# ========== FEATURE FLAGS ==========
FEATURE_AUTO_MATCHING=true
FEATURE_EMAIL_NOTIFICATIONS=false


# Vision Service
VISION_SERVICE_URL=http://localhost:8002
VISION_SERVICE_TIMEOUT=30
ENABLE_VISION_CACHE=true

# ========== Redis Configuration ==========
REDIS_URL=redis://localhost:6379/0
REDIS_CACHE_TTL=3600
REDIS_MAX_CONNECTIONS=10
ENABLE_REDIS_CACHE=true

# ========== Media Storage ==========
MEDIA_ROOT=/app/media
MEDIA_URL=/media
MAX_UPLOAD_SIZE_MB=10
STRIP_EXIF=true

# ========== Matching Configuration ==========
# Match scoring weights (must sum to ~1.0)
MATCH_WEIGHT_TEXT=0.45
MATCH_WEIGHT_IMAGE=0.35
MATCH_WEIGHT_GEO=0.15
MATCH_WEIGHT_TIME=0.05

# Match thresholds
MATCH_MIN_SCORE=0.65
MATCH_TEXT_THRESHOLD=0.70
MATCH_IMAGE_THRESHOLD=0.75
MATCH_GEO_RADIUS_KM=5.0
MATCH_TIME_WINDOW_DAYS=30

# ANN search parameters
ANN_TOP_K=50
MATCH_MAX_RESULTS=20

# ========== Pagination ==========
DEFAULT_PAGE_SIZE=20
MAX_PAGE_SIZE=100

# ========== Rate Limiting ==========
ENABLE_RATE_LIMIT=true
RATE_LIMIT_AUTH=5/minute
RATE_LIMIT_UPLOAD=10/minute
RATE_LIMIT_CREATE_REPORT=20/hour
RATE_LIMIT_SEARCH=60/minute
RATE_LIMIT_STORAGE=redis

# ========== Security & CORS ==========
CORS_ORIGINS=http://localhost:3000,http://10.0.2.2:8000
CORS_ALLOW_CREDENTIALS=true
ENABLE_SECURITY_HEADERS=true

# ========== Monitoring & Metrics ==========
ENABLE_METRICS=true
METRICS_PORT=9090

# ========== Notifications ==========
ENABLE_NOTIFICATIONS=true
NOTIFICATION_BATCH_SIZE=100

# ========== Admin Panel ==========
ADMIN_SESSION_SECRET=change-this-in-production
ADMIN_SESSION_LIFETIME_HOURS=8
ENABLE_ADMIN_PANEL=true

# ========== Localization ==========
DEFAULT_LANGUAGE=en

# ========== Background Tasks ==========
ENABLE_BACKGROUND_TASKS=true
ARQ_REDIS_URL=redis://localhost:6379/0

# ========== Feature Flags ==========
ENABLE_WEBSOCKETS=false
ENABLE_PUSH_NOTIFICATIONS=false
ENABLE_AUDIT_LOG=true

# ========== Timeouts ==========
REQUEST_TIMEOUT=30
BACKGROUND_TASK_TIMEOUT=300
